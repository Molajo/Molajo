* * * * To do * * * *

Migrate Module models to Model Service and DBO's

Includers - update for new formats (create new tag, formfields)

Triggers - get data access triggers working - Display triggers in place

Constants - reduce - Application class

Text Filters - get text filters hooked up to groups and separate HTMLPurifier as an add on option

Registry - "lock" a registry

Events - currently, static connection to all, change to dynamic

Install - core, extensions, packages - do this last

Dates - hookup UTC with user and date routines

Sessions - connect to Symfony's

Cache - one of the last things - SIMPLE approach, first using files, then add adapters,
    solution should work for file xml, templates, queries, registries, pages, assets


* * * Not part of Core / Part of "sample" install * * *

Molajito Theme -

Create a Responsive package (separate from Core since new solutions emerge quickly in this area, don't lock in)

1. Images - http://adaptive-images.com/

2. Video - IFrame trigger

3. Layout Grid

4. Gmaps - http://hpneo.github.com/gmaps/examples/geolocation.html

5. RESS - Server side detection http://www.brettjankord.com/2012/02/29/hrwd-hybrid-responsive-web-design/

6. Client side detection - Modernizer

Mustache package

Twig Package

Admin Theme Package




* * * * Database Code useful during development * * * *

1. Review

Services::Registry()->get('Parameters', '*');


2. add an extension

INSERT INTO `molajo`.`molajo_extensions` ( `id` , `extension_site_id` , `catalog_type_id` , `name`) VALUES ( NULL ,  '1',  '1200',  ' Search');

INSERT INTO `molajo`.`molajo_extension_instances` (`id`, `extension_id`, `catalog_type_id`, `title`, `subtitle`, `alias`, `content_text`, `protected`, `featured`, `stickied`, `status`, `start_publishing_datetime`, `stop_publishing_datetime`, `version`, `version_of_id`, `status_prior_to_version`, `created_datetime`, `created_by`, `modified_datetime`, `modified_by`, `checked_out_datetime`, `checked_out_by`, `customfields`, `parameters`, `metadata`, `language`, `translation_of_id`, `ordering`)
select null, a.id, a.catalog_type_id, a.name, 'templates', '', '', '1', '0', '0', '1', '2011-11-11 11:11:11', '0000-00-00 00:00:00', '1', '0', '0', '2011-11-11 11:11:11', '0', '2011-11-11 11:11:11', '0', '0000-00-00 00:00:00', '0', '{}', '', NULL, 'en-GB', '0', '41'
from molajo_extensions a
where id > 259

INSERT INTO `molajo`.`molajo_site_extension_instances` (`extension_instance_id`, `site_id`)
SELECT a.id, 1
from molajo_extension_instances a
where id > 259

INSERT INTO `molajo`.`molajo_application_extension_instances` (`extension_instance_id`, `application_id`)
SELECT a.id, b.id
from molajo_extension_instances a,
molajo_applications b
where a.id > 259

INSERT INTO `molajo`.`molajo_catalog` ( `id` , `catalog_type_id` , `source_id` , `routable` , `sef_request` , `redirect_to_id` , `view_group_id` , `primary_category_id` , `tinyurl` )
SELECT NULL ,  a.catalog_type_id,  a.id,  '1',  'extensions/views/',  '0',  '1',  '0',  ''
from molajo_extension_instances a
where a.id > 259


3. remove an extension

delete from `molajo_application_extension_instances` WHERE `extension_instance_id` in (111, 112, 113, 114, 117, 118)

delete from `molajo_application_extension_instances` WHERE `extension_instance_id` in (111, 112, 113, 114, 117, 118)

delete from `molajo_group_permissions` WHERE catalog_id in (select distinct id from `molajo_catalog` WHERE `source_id` in (111, 112, 113, 114, 117, 118) and `catalog_type_id` = 1350)

delete from `molajo_view_group_permissions` WHERE catalog_id in (select distinct id from `molajo_catalog` WHERE `source_id` in (111, 112, 113, 114, 117, 118) and `catalog_type_id` = 1350)

delete from `molajo_catalog` WHERE `source_id` in (111, 112, 113, 114, 117, 118) and `catalog_type_id` = 1350

delete from `molajo_extension_instances` WHERE `extension_instance_id` in (111, 112, 113, 114, 117, 118)

4. rebuild security

drop and recreate

CREATE TABLE `molajo_view_group_permissions` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `view_group_id` int(11) unsigned NOT NULL COMMENT 'Foreign Key to molajo_groups.id',
  `catalog_id` int(11) unsigned NOT NULL COMMENT 'Foreign Key to molajo_catalog.id',
  `action_id` int(11) unsigned NOT NULL COMMENT 'Foreign Key to molajo_actions.id',
  PRIMARY KEY (`id`),
  KEY `fk_view_group_permissions_view_groups_index` (`view_group_id`),
  KEY `fk_view_group_permissions_actions_index` (`action_id`),
  KEY `fk_view_group_permissions_catalog_index` (`catalog_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;


INSERT INTO `molajo_view_group_permissions` (view_group_id, catalog_id, action_id)

SELECT b.view_group_id, c.id, c.id

FROM `molajo_content` a,
 `molajo_group_view_groups` b,
 `molajo_catalog` c,
 `molajo_actions` d
WHERE a.`catalog_type_id` in (100, 120)
  AND a.id = b.group_id
  AND b.view_group_id = c.view_group_id
  AND d.title = 'view'
